---
import { getCollection } from 'astro:content'
import BaseLayout from '../layouts/BaseLayout.astro'
import BlogCard from '../components/BlogCard.astro'
import HeroSection from '../components/HeroSection.astro'

// Get all posts
const allPosts = await getCollection('blog')
const posts = allPosts
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 6)
---

<BaseLayout title="Khoi Van" description="Personal blog about Android development, software engineering, and life in Saigon">
  <!-- Hero Section with Bio -->
  <HeroSection />
  
  <!-- Blog Posts -->
  <div class="container-narrow pb-16">
    <h2 class="text-xl font-semibold mb-6 mt-2">Recent Posts</h2>
    <div class="space-y-6">
      {posts.map((post) => (
        <BlogCard post={post} />
      ))}
    </div>

    <!-- View All Posts -->
    <div class="mt-10 text-center">
      <a href="/blog" class="inline-block px-6 py-2 rounded-lg border-2 border-current opacity-70 hover:opacity-100 transition-opacity no-underline text-sm font-semibold">
        View all posts â†’
      </a>
    </div>
  </div>
</BaseLayout>